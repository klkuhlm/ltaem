module gauss_points

  implicit none
  private
  public :: Gauss_Quad_Setup

  contains

  !%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  subroutine Gauss_Quad_Setup(intOrd,coord,weight)
    use constants, only : DP

    integer, intent(in) :: intOrd    ! Gauss integration order
    real(DP), intent(out), dimension(:) :: coord,weight

    ! from Stroud & Secrest "Gaussian Quadrature Formulas", 1966: Table 1
    ! compared to quad-precision output from GAULEG() subroutine
    ! in Antia numerical methods book (weights and abscissa agree to >= 30 places)
    select case (intOrd)
    case(1)
       coord(1) = 0.0_DP
       weight(1) = 2.0_DP
    case(2)
       coord(1) = 0.577350269189625764509148780502_DP
       coord(2) = -coord(1)
       weight(1:2) = 1.0_DP
    case(3)
       coord(1:2) = (/ 0.774596669241483377035853079956_DP, 0.0_DP /)
       coord(3) = -coord(1)
       weight(1:2) = (/ 0.55555555555555555555555555556_DP, &
                      & 0.88888888888888888888888888889_DP /)
       weight(3) = weight(1)
    case(4)
       coord(1:2) = (/ 0.861136311594052575223946488893_DP, &
                     & 0.339981043584856264802665759103_DP /)
       coord(3:4) = -coord(2:1:-1)
       weight(1:2) = (/ 0.347854845137453857373063949222_DP, &
                      & 0.652145154862546142626936050778_DP /)
       weight(3:4) = weight(2:1:-1)
    case(5)
       coord(1:3) = (/ 0.906179845938663992797626878299_DP, &
                     & 0.538469310105683091036314420700_DP, 0.0_DP /)
       coord(4:5) = -coord(2:1:-1)
       weight(1:3) = (/ 0.236926885056189087514264040720_DP, &
                      & 0.478628670499366468041291514836_DP, &
                     &  0.568888888888888888888888888889_DP /)
       weight(4:5) = weight(2:1:-1)
    case(6)
       coord(1:3) = (/ 0.932469514203152027812301554494_DP, &
                     & 0.661209386466264513661399595020_DP, &
                     & 0.238619186083196908630501721681_DP /)
       coord(4:6) = -coord(3:1:-1)
       weight(1:3) = (/ 0.171324492379170345040296142173_DP, &
                      & 0.360761573048138607569833513838_DP, &
                     &  0.467913934572691047389870343990_DP /)
       weight(4:6) = weight(3:1:-1)
    case(7)
       coord(1:4) = (/ 0.949107912342758524526189684048_DP, &
                     & 0.741531185599394439863864773281_DP, &
                     & 0.405845151377397166906606412077_DP, 0.0_DP /)
       coord(5:7) = -coord(3:1:-1)
       weight(1:4) = (/ 0.129484966168869693270611432679_DP, &
                      & 0.279705391489276667901467771424_DP, &
                      & 0.381830050505118944950369775489_DP, &
                      & 0.417959183673469387755102040816_DP /)
       weight(5:7) = weight(3:1:-1)
    case(8)
       coord(1:4) = (/ 0.960289856497536231683560868569_DP, &
                     & 0.796666477413626739591553936476_DP, &
                     & 0.525532409916328985817739049189_DP, &
                     & 0.183434642495649804939476142360_DP /)
       coord(5:8) = -coord(4:1:-1)
       weight(1:4) = (/ 0.101228536290376259152531354310_DP, &
                      & 0.222381034453374470544355994426_DP, &
                      & 0.313706645877887287337962201987_DP, &
                      & 0.362683783378361982965150449277_DP /)
       weight(5:8) = weight(4:1:-1)
    case(9)
       coord(1:5) = (/ 0.968160239507626089835576202904_DP, &
                     & 0.836031107326635794299429788070_DP, &
                     & 0.613371432700590397308702039341_DP, &
                     & 0.324253423403808929038538014643_DP, 0.0_DP /)
       coord(6:9) = -coord(4:1:-1)
       weight(1:5) = (/ 0.0812743883615744119718921581105_DP, &
                      & 0.180648160694857404058472031243_DP, &
                      & 0.260610696402935462318742869419_DP, &
                      & 0.312347077040002840068630406584_DP, &
                      & 0.330239355001259763164525069287_DP /)
       weight(6:9) = weight(4:1:-1)
    case(10)
       coord(1:5) = (/ 0.973906528517171720077964012084_DP, &
                     & 0.865063366688984510732096688423_DP, &
                     & 0.679409568299024406234327365115_DP, &
                     & 0.433395394129247190799265943166_DP, &
                     & 0.148874338981631210884826001130_DP /)
       coord(6:10) = -coord(5:1:-1)
       weight(1:5) = (/ 0.0666713443086881375935688098933_DP, &
                      & 0.149451349150580593145776339658_DP, &
                      & 0.219086362515982043995534934228_DP, &
                      & 0.269266719309996355091226921569_DP, &
                      & 0.295524224714752870173892994651_DP /)
       weight(6:10) = weight(5:1:-1)
    case(12) 
       coord(1:6) = (/ 0.981560634246719250690549090149_DP, &
                     & 0.904117256370474856678465866119_DP, &
                     & 0.769902674194304687036893833213_DP, &
                     & 0.587317954286617447296702418941_DP, &
                     & 0.367831498998180193752691536644_DP, &
                     & 0.125233408511468915472441369464_DP /)
       coord(7:12) = -coord(6:1:-1)
       weight(1:6) = (/ 0.0471753363865118271946159614850_DP, &
                      & 0.106939325995318430960254718194_DP, &
                      & 0.160078328543346226334652529543_DP, &
                      & 0.203167426723065921749064455810_DP, &
                      & 0.233492536538354808760849898925_DP, &
                      & 0.249147045813402785000562436043_DP /)
       weight(7:12) = weight(6:1:-1)
    case(20) 
       coord(1:10) = (/ 0.993128599185094924786122388471_DP, &
                      & 0.963971927277913791267666131197_DP, &
                      & 0.912234428251325905867752441203_DP, &
                      & 0.839116971822218823394529061702_DP, &
                      & 0.746331906460150792614305070356_DP, &
                      & 0.636053680726515025452836696226_DP, &
                      & 0.510867001950827098004364050955_DP, &
                      & 0.373706088715419560672548177025_DP, &
                      & 0.227785851141645078080496195369_DP, &
                      & 0.0765265211334973337546404093988_DP /)
       coord(11:20) = -coord(10:1:-1)
       weight(1:10) = (/ 0.0176140071391521183118619623519_DP, &
                       & 0.0406014298003869413310399522749_DP, &
                       & 0.0626720483341090635695065351870_DP, &
                       & 0.0832767415767047487247581432220_DP, &
                       & 0.101930119817240435036750135480_DP, &
                       & 0.118194531961518417312377377711_DP, &
                       & 0.131688638449176626898494499748_DP, &
                       & 0.142096109318382051329298325067_DP, &
                       & 0.149172986472603746787828737002_DP, &
                       & 0.152753387130725850698084331955_DP /)
       weight(11:20) = weight(10:1:-1)
    case(40)
       coord(1:20) = (/  9.98237709710559D-01, &
                      &  9.90726238699457D-01, &
                      &  9.77259949983774D-01, &
                      &  9.57916819213792D-01, &
                      &  9.32812808278676D-01, &
                      &  9.02098806968874D-01, &
                      &  8.65959503212259D-01, &
                      &  8.24612230833312D-01, &
                      &  7.78305651426519D-01, &
                      &  7.27318255189927D-01, &
                      &  6.71956684614180D-01, &
                      &  6.12553889667980D-01, &
                      &  5.49467125095128D-01, &
                      &  4.83075801686179D-01, &
                      &  4.13779204371605D-01, &
                      &  3.41994090825759D-01, &
                      &  2.68152185007253D-01, &
                      &  1.92697580701371D-01, &
                      &  1.16084070675255D-01, &
                      &  3.87724175060509D-02 /)
       coord(21:40) = -coord(20:1:-1)
       weight(1:20) = (/  4.52127709853341D-03, &
                      &   1.04982845311527D-02, &
                      &   1.64210583819076D-02, &
                      &   2.22458491941668D-02, &
                      &   2.79370069800237D-02, &
                      &   3.34601952825475D-02, &
                      &   3.87821679744725D-02, &
                      &   4.38709081856732D-02, &
                      &   4.86958076350722D-02, &
                      &   5.32278469839365D-02, &
                      &   5.74397690993916D-02, &
                      &   6.13062424929288D-02, &
                      &   6.48040134566009D-02, &
                      &   6.79120458152347D-02, &
                      &   7.06116473912866D-02, &
                      &   7.28865823958044D-02, &
                      &   7.47231690579680D-02, &
                      &   7.61103619006269D-02, &
                      &   7.70398181642465D-02, &
                      &   7.75059479784256D-02 /)
       weight(21:40) = weight(20:1:-1)
    case default
       print *, 'unsupported Gaussian Quadrature integration order:', intOrd
       stop
    end select

  end subroutine Gauss_Quad_Setup

end module gauss_points
